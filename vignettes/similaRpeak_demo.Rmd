---
title: "similaRpeak: Using metagene output to compare profiles"
author: "Charles Joly Beauparlant, Fabien C. Lamaze, Astrid L. Deschênes, 
Rawane Samb, Elsa Bernatchez, Pascal Belleau, Steve Bilodeau and Arnaud Droit"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{similaRpeak: Using metagene output to compare profiles}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

# Enrichment of the H3K27ac histone mark in active and bivalent transcription start sites (TSS) #

## Introduction

The H3K27ac histone mark is normally enriched at active compared to poised 
transcriptional start sites (TSS) (Roadmap Epigenomics Consortium et al.,2015).
_metagene_  has been used to robustly test for the difference in enrichment of 
H3K27ac between these two groups of promoter regions in A549 cells. 


### 1. Load _metagene_ results data

The results have been saved in a `list` that can be loaded and used by 
`similaRpeak`. The `list` contains 2 elements: a `data.frame` and a Friedman test 
results. Only the `data.frame` is needed.

```{r loadData}
load("../data/df.RData")
DF<-df[["DF"]]
```

The `data.frame` content can be used to recreate the _metagene_ graph.

```{r graph, fig.height=5, fig.width=7, echo=FALSE}
library(ggplot2)
p <- ggplot(DF, aes(x=position, y=value, ymin=qinf, ymax=qsup))
p + geom_ribbon(aes(fill=group), alpha=0.3) + 
    geom_line(aes(color=group), size=1, litype=1, bg="transparent") +
    ylab("Reads per million (RPM)") 

```

### 2. Load _similaRpeak_ package

The _similaRpeak_ package must be loaded.

```{r loadPackage, warning=FALSE, collapse=TRUE}
library(similaRpeak)
```



## References 

Roadmap Epigenomics Consortium et al. (2015). Integrative analysis of 111 
reference human epigenomes. Nature, 518: 317–330.

